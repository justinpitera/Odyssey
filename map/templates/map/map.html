{% extends 'base.html' %}
{% block content %}
{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>Full Screen Map</title>
    <link rel="stylesheet" href="{% static 'map/css/styles.css' %}">



    <!-- Leaflet related styles and scripts -->
    <link rel="stylesheet" href="{% static 'leaflet/css/leaflet.css'%}" />
    <script src="{% static 'leaflet/js/leaflet.js' %}"></script>
    <script src="{% static 'leaflet/js/leaflet-ant-path.js' %}"></script>
    <script src="{% static 'leaflet/js/leaflet.markercluster-src.js' %}"></script>

    <script src='https://api.mapbox.com/mapbox-gl-js/v3.1.2/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v3.1.2/mapbox-gl.css' rel='stylesheet' />



</head>
<body>

    <!-- Map toolbar -->
    <div id="map-toolbar" style="position: absolute; bottom: 25px; right: 20px; z-index: 1000; display: flex;">
        
        <button id="toggle-rotation" class="toolbar-btn">
            <i class="fa-solid fa-magnifying-glass-arrows-rotate"></i>
        </button>
        <button class="toolbar-btn">
            <i class="fa-solid fa-layer-group"></i>
        </button>
        <button id="filters-btn" class="toolbar-btn">
            <i class="fas fa-filter"></i>
        </button>

        <!-- You can add more buttons with different functionalities as needed -->
    </div>


<!-- Filters modal -->
<div id="modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-0 overflow-y-auto h-full w-full" style="z-index: 1050;">
    <div class="relative top-40 mx-auto p-5 w-96 shadow-lg rounded-md bg-gray-900" style="transition: transform .5s ease;">
        <div class="flex justify-between items-center">
            <h3 class="text-xl">Filters</h3>
            <button id="close-modal" class="text-black">&times;</button>
        </div>
        <div class="my-4">
            <p>Content for filters...</p>
        </div>
        <div class="flex justify-end">
            <button class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-700 transition duration-300">Apply</button>
        </div>
    </div>
</div>


<div id="map"></div>



<script src="{% static 'map/js/modal.js' %}"></script>



    
    

<!-- Map related scripts -->
<script>
    mapboxgl.accessToken = 'pk.eyJ1Ijoib2R5c3NleWNsaWVudCIsImEiOiJjbHQ2MGh2NDMwNmE2MnJvZXhwdWIwZmJpIn0._1PC-pg9OaMJldN9svTWwg';
    const map = new mapboxgl.Map({
        container: 'map', // container ID
        style: 'mapbox://styles/mapbox/dark-v11', // A style suitable for the globe view
        center: [0, 0], // starting position
        zoom: 1, // starting zoom
        projection: 'globe' // Enable the globe projection
    });
    
    map.on('rotate', function() {
        Object.values(aircraftMarkers).forEach(({marker, heading}) => {
            const el = marker.getElement();
            updateIconRotation(el, heading);
        });
    });
    map.on('rotate', () => {
    Object.keys(aircraftMarkers).forEach(flight_number => {
    const markerObj = aircraftMarkers[flight_number];
    if (markerObj) {
    updateIconRotation(markerObj.marker.getElement(), markerObj.heading);
    }
    });
    });
    map.on('load', () => {

          // Set the terrain source
        map.setTerrain({ 'source': 'mapbox-dem', 'exaggeration': 1.5 });

        // Ensure the sky layer is added after the map has loaded
        map.addLayer({
            'id': 'sky',
            'type': 'sky',
            'paint': {
                'sky-type': 'atmosphere',
                'sky-atmosphere-sun': [0.0, 0.0], // Position the sun directly overhead to minimize sunlight effect
                'sky-atmosphere-sun-intensity': 15, // Intensify the sun effect for more dramatic sky coloring
                'sky-atmosphere-color': '#000511', // Dark blue color for the night sky
                'sky-opacity': [
                    'interpolate',
                    ['linear'],
                    ['zoom'],
                    0,
                    1,
                    22,
                    1
                ]
            }
        });
    
        // Adjusting the fog properties to make it less intense
        map.setFog({
            'color': '#000', // Slightly blue-gray color to blend with the night sky, adjust as needed
            'range': [1.0, 20], // Increase the start range to make the fog appear further away
            'horizon-blend': 0.1, // A subtle blend towards the horizon
        });
    });
    </script>
    

<script src="{% static 'map/js/airports.js' %}"></script>
<script src="{% static 'map/js/aircraft.js' %}"></script>
<script src="{% static 'map/js/waypoints.js' %}"></script>
{% comment %}
    


{% endcomment %}
</body>
</html>
{% endblock %}
